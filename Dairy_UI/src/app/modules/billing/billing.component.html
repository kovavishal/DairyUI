
<section class="flex flexcenter">

  <mat-card class="matcard">
        <mat-card-header class="mainheader">
            <mat-card-title>BILLING PAGE</mat-card-title>
        </mat-card-header>
        <mat-card-content class="mainpage">
            <form [formGroup]="billingForm"  (ngSubmit)="onSubmit()">
                <div class="flex search-container">
                    <mat-form-field style="margin-right:3%;">
                        <input matInput [matDatepicker]="picker" placeholder="Choose a date" formControlName="inputDate" required>
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                      </mat-form-field>
                    <!-- <input type="date" class="mat-date" (change)="SendDataonChange($event)" /> -->
                <mat-form-field class="item item-s6">
                    <mat-label>Select Customer</mat-label>
                    <mat-select formControlName="customer" required>
                        <mat-option *ngFor="let customer of Customer"
                        [value]="customer.user_id">{{customer.user_name}}</mat-option>
                    </mat-select>
                </mat-form-field>
           
                <!-- <matButton [mat-mini-fab]>
                    <mat-icon aria-hidden="false"
                        style="color: green; font-size: 44px; width: 44px; height: 44px;"
                        fontIcon="add"></mat-icon>
                </matButton> -->
                
                <button mat-raised-button matTooltip="Add Item" class="mdc-fab mdc-fab--mini" aria-label="add" (click)="addRow($event)" class="mat-elevation-z1 item-s5">
                    <div class="mdc-fab__ripple"></div>
                    <span class="mdc-fab__icon material-icons">add</span>
                </button>
</div>
<div>
    <table mat-table [dataSource]="myformArray.controls" class="mat-elevation-z8">
        <ng-container matColumnDef="product_name" >
            <th mat-header-cell class="table-header-cell" *matHeaderCellDef> Product </th>
            <td mat-cell *matCellDef="let element;let i=index;">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <mat-label>Select Product</mat-label>
                    <mat-select [formControl]="element.get('product_name')" required 
                    (selectionChange)='onProductSelected($event.value, i)'>
                        <mat-option *ngFor="let product of products"
            [value]="product.product_id">{{product.product_name}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </td>

        </ng-container>
        <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef> Crates </th>

            <td mat-cell *matCellDef="let element">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <input matInput [formControl]="element.get('quantity')" required (keypress)="onlyNumberKey($event)">
                </mat-form-field>
            </td>
        </ng-container>
        <ng-container matColumnDef="extras">
            <th mat-header-cell *matHeaderCellDef> Litres </th>

            <td mat-cell *matCellDef="let element;let i=index;">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <input matInput [formControl]="element.get('extras')" (focusout)="focusOutFunction($event, i)" (keypress)="onlyDecimalNumberKey($event)" required>
                </mat-form-field>
            </td>
        </ng-container>
        <ng-container matColumnDef="rate">
            <th mat-header-cell *matHeaderCellDef> Rate/Unit</th>

            <td mat-cell *matCellDef="let element">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <input matInput [formControl]="element.get('rate')" readonly="true">
                </mat-form-field>
            </td>
        </ng-container>
        <ng-container matColumnDef="cgst_percentage">
            <th mat-header-cell *matHeaderCellDef> CGST (%)</th>

            <td mat-cell *matCellDef="let element">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <input matInput [formControl]="element.get('cgst_percentage')" readonly="true">
                </mat-form-field>
            </td>
        </ng-container>
        <ng-container matColumnDef="sgst_percentage">
            <th mat-header-cell *matHeaderCellDef> SGST (%)</th>

            <td mat-cell *matCellDef="let element">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <input matInput [formControl]="element.get('sgst_percentage')" readonly="true">
                </mat-form-field>
            </td>
        </ng-container>
        <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef> Amount </th>

            <td mat-cell *matCellDef="let element">
                <mat-form-field style="margin-top:20px;" appearance="outline">
                    <input matInput [formControl]="element.get('amount')" readonly="true">
                </mat-form-field>
            </td>
        </ng-container>
        <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef> Action </th>

            <td mat-cell *matCellDef="let element;let i=index;">
                <button mat-button class="mdc-fab mdc-fab--mini" class="mat-elevation-z1" [disabled]="isLastRow"
                    (click)="removeRow(i)">
                    <div class="mdc-fab__ripple"></div>
                    <span class="mdc-fab__icon material-icons" >close</span>
                </button>
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
                <!-- <mat-table [dataSource]="dataSource" style="height:600px; overflow-y: auto; padding-left:5px"> -->

                    
                   
                <!-- </mat-table> -->
</div>
<div style="align-items: normal; margin-top:12px;" class="flex flexend">
    <div class="rpadding">
        <!-- <mat-form-field mat-sized-input>
            <mat-label>Total Amount</mat-label> -->
            <input class="mat-sized-input" matInput formControlName="totalAmount" placeholder="Total Amount" [readonly]="true" >
        <!-- </mat-form-field> -->
    </div>
    <div class="rpadding">
                <button mat-raised-button color="primary" type="submit">Submit</button>
            </div>
            </div>
            </form>
        </mat-card-content>
    </mat-card>
</section>

